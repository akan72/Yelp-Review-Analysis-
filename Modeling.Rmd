---
title: "Modeling"
author: "Alex Kan -lexokan"
date: "April 14, 2018"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(stringr)
library(data.table)

library(e1071)
library(tree)

set.seed(1)
```

```{r}
df <- read.csv("data/phoenixAg.csv")
temp <- df

temp <- temp %>% 
    select(-c(businessID, businessName, city))

```

PCA:
```{r}
pca <- prcomp(temp)

biplot(pca)
```

SVM: 
```{r}
svm.mod <- svm(data = temp, avgReviewStars~., kernel = "linear", scale = F, cost = .1)
```
Decision Trees: 
```{r}
tree.mod <- tree(data = temp %>% 
                     select(-c(averageReviewBusiness, avgUserPastReview)), avgReviewStars ~.)

#plot(tree(data = temp,
#     as.formula(paste("avgReviewStars", "~",
#                      paste(colnames(temp)[8:16], collapse = "+"),
#                      sep = ""))))

plot(tree.mod)
text(tree.mod, pretty = 0)
```

Kmeans: 
```{r}

```

Logistic Regression
