---
title: "Cleaning"
author: "Alex Kan -lexokan"
date: "April 11, 2018"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(data.table)
```

```{r, eval = F}
# Read in original sample of 1/10 of Yelp Kaggle Datset 
sample <- fread("sample.csv")

# Read in kaggle tables 
hours <- read.csv("C:/Users/lexokan/Desktop/Yelp/yelp_business_hours.csv", fill = T)
business <- fread("C:/Users/lexokan/Desktop/Yelp/yelp_business.csv")
user<- fread("C:/Users/lexokan/Desktop/Yelp/yelp_user.csv")

```

```{r, eval = F}
sample <- merge(sample, business, by = "business_id", all = T)
sample <- merge(sample, hours, by = "business_id", all = T)
sample <- merge(sample, user, by = "user_id")

#write.csv(sample, "sample3.csv")
```

```{r}
df <- fread("C:/Users/lexokan/Desktop/Yelp/sample3.csv")
vegas <- read.csv("data/vegasDemographics.csv")
phoenix <- read.csv("data/phoenixDemographics.csv")
```

```{r}

# Read in zipcodes of cities within a 30 mile radius of Las Vegas and Phoenix
vegasZips <- as.vector(as.character(vegas$FIPS))
phoenixZips <- as.vector(as.character(phoenix$FIPS))

vegas <- df[, 2:51] %>% 
    select(-c(V1, neighborhood, state, name.y, friends, elite, address)) %>% 
    filter(str_detect(categories, "Restaurants"), postal_code %in% vegasZips) %>% 
    select(-c(text, categories, monday, tuesday, wednesday, thursday, friday, saturday, sunday))


phoenix <- df[, 2:51] %>% 
    select(-c(V1, neighborhood, state, name.y, friends, elite, address)) %>% 
    filter(str_detect(categories, "Restaurants"), postal_code %in% phoenixZips) %>% 
    select(-c(text, categories, monday, tuesday, wednesday, thursday, friday, saturday, sunday))

write.csv(vegas, "vegas.csv")
write.csv(phoenix, "phoenix")

```
